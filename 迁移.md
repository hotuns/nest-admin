# MySQL 迁移到 PostgreSQL 重构计划表

## 1. 需求分析与准备
- [*] 评估现有系统与数据表结构
- [*] 备份当前 MySQL 数据库
- [*] 安装 PostgreSQL 数据库及客户端工具

## 2. 依赖与配置调整
- [ ] 移除 MySQL 相关依赖（如 mysql2）
- [ ] 安装 PostgreSQL 依赖（pg、@types/pg）
- [ ] 修改 `src/config/database.config.ts`，将 type 改为 `postgres`，端口改为 5432
- [ ] 更新 `.env` 文件中的数据库配置项

## 3. 数据迁移
- [ ] 使用工具导出 MySQL 数据（如 mysqldump）
- [ ] 手动或借助工具（如 pgloader）转换 SQL 语法为 PostgreSQL 兼容格式
- [ ] 在 PostgreSQL 中创建新数据库
- [ ] 导入转换后的数据

## 4. 代码层面重构
- [ ] 检查并调整所有实体类的数据类型，确保兼容 PostgreSQL
- [ ] 检查并修改所有原生 SQL 查询，适配 PostgreSQL 语法
- [ ] 检查 TypeORM 配置及用法，确保无 MySQL 特有配置

## 5. 测试与验证
- [ ] 本地开发环境下完整测试所有功能
- [ ] 验证数据完整性与一致性
- [ ] 性能与兼容性测试

## 6. 部署上线
- [ ] 更新生产环境数据库配置
- [ ] 执行数据迁移
- [ ] 部署新版本应用

## 7. 回滚与备份
- [ ] 保留 MySQL 完整备份
- [ ] 准备回滚脚本与方案
- [ ] 记录所有变更细节

---

> 建议每一步都做好详细记录，迁移前后多次备份，确保数据安全。
